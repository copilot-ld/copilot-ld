syntax = "proto3";

package memory;

import "common.proto";
import "resource.proto";
import "tool.proto";

service Memory {
  rpc AppendMemory(AppendRequest) returns (AppendResponse);
  rpc GetWindow(WindowRequest) returns (WindowResponse);
  rpc GetBudget(BudgetRequest) returns (BudgetResponse);
}

message AppendRequest {
  string resource_id = 1;
  repeated resource.Identifier identifiers = 2;
}

message AppendResponse {
  string accepted = 1;
}

message WindowRequest {
  string resource_id = 1;
  string model = 2;
}

message WindowResponse {
  repeated common.Message messages = 1;
  repeated tool.ToolCall tools = 2;
}

message BudgetRequest {
  string resource_id = 1;
  string model = 2;
}

message BudgetResponse {
  int32 total = 1;
  int32 overhead = 2;
  int32 available = 3;
}
