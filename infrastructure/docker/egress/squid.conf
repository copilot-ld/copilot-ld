# Squid proxy configuration for Copilot-LD egress
# Minimal configuration for HTTP/HTTPS proxying

# Listen on all interfaces
http_port 3128

# Access control - allow internal networks
acl localnet src 10.0.0.0/8
acl localnet src 172.16.0.0/12
acl localnet src 192.168.0.0/16

# Allow SSL ports for CONNECT method
acl SSL_ports port 443
acl CONNECT method CONNECT

# Deny CONNECT to non-SSL ports
http_access deny CONNECT !SSL_ports

# Allow localhost
http_access allow localhost

# Allow local networks
http_access allow localnet

# Deny all other access
http_access deny all

# Cache settings - minimal caching for proxy
cache deny all

# Logging
access_log /var/log/squid/access.log
cache_log /var/log/squid/cache.log

# DNS settings
dns_nameservers 8.8.8.8 8.8.4.4

# Disable via header to avoid proxy detection
via off

# Forwarded-for header configuration
forwarded_for delete
